<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Espelho de Notas e Flu√™ncia</title>

<script src="crypto-js.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 1200px;
  margin: auto;
  padding: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
}

th {
  background: #f0f0f0;
}

input, select, textarea, button {
  padding: 6px;
  margin: 4px;
}

button {
  background: #1976d2;
  color: white;
  border: none;
  cursor: pointer;
}
</style>
</head>

<body>

<h2>Espelho de Notas e Flu√™ncia Leitora</h2>

<label>Turma (ex: 5anoc)</label>
<input id="turma">

<button onclick="adicionarLinha()">‚ûï Adicionar aluno</button>
<button onclick="gerarHTML()">üîê Gerar HTML criptografado</button>

<table>
<thead>
<tr>
  <th>RA</th>
  <th>Nome</th>
  <th>Matem√°tica</th>
  <th>Portugu√™s</th>
  <th>Flu√™ncia</th>
  <th>Observa√ß√£o</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
function adicionarLinha() {
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td><input></td>
    <td><input></td>
    <td><input type="number" step="0.1"></td>
    <td><input type="number" step="0.1"></td>
    <td>
      <select>
        <option>Pr√©-leitor</option>
        <option>Iniciante</option>
        <option>Em desenvolvimento</option>
        <option>Fluente</option>
        <option>Fluente com compreens√£o</option>
      </select>
    </td>
    <td><textarea rows="2"></textarea></td>
  `;
  document.getElementById("tbody").appendChild(tr);
}

function gerarHTML() {
  const turma = document.getElementById("turma").value.trim();
  if (!turma) {
    alert("Informe a turma.");
    return;
  }

  const registros = [];
  document.querySelectorAll("#tbody tr").forEach(tr => {
    const c = tr.querySelectorAll("input, select, textarea");
    const ra = c[0].value.trim();
    if (!ra) return;

    const aluno = {
      ra: ra,
      nome: c[1].value,
      turma: turma,
      notas: {
        Matem√°tica: c[2].value,
        Portugu√™s: c[3].value
      },
      fluencia: {
        nivel: c[4].value,
        observacoes: c[5].value
      }
    };

    const criptografado = CryptoJS.AES.encrypt(
      JSON.stringify(aluno),
      ra
    ).toString();

    registros.push({ ra: ra, dados: criptografado });
  });

  const htmlFinal = `
<!DOCTYPE html>
<html>
<head><meta charset="UTF-8"></head>
<body>
<script>
const DADOS_TURMA = ${JSON.stringify(registros, null, 2)};
<\/script>
</body>
</html>
`;

  const blob = new Blob([htmlFinal], { type: "text/html" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "dados.html";
  link.click();
}
</script>

</body>
</html>
